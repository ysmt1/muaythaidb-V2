{% extends 'mtdb/base.html' %}
{% load static %}
{% block meta %}
    <meta name="description" content="User review portal of Muay Thai Gyms in Thailand.  Find the right gym for you">
{% endblock %}
{% block stylesheets %}
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,700i&display=swap" rel="stylesheet">
{% endblock %}
{% block title %}Muay Thai DB{% endblock %}
{% block content %}
<div class="row justify-content-center my-3">
    <h3 class="text-center welcome">Welcome to Muay Thai DB!</h3>
</div>
<div class="row justify-content-center">
    <div class="col-md-3">
        <img src="{% static 'mtdb/img/imagebg.jpg' %}" class="img-fluid img-logo">
        <div class="sidebar-div my-2">
            <h5 class="sidebar-header">Search</h5>
            <div class="form-group">
                <input type="text" id="filterRow" class="form-control my-2" placeholder="Gym, Location" autocomplete="off">
            </div>
            <div class="custom-control custom-switch my-3">
                <input type="checkbox" class="custom-control-input" id="hideRows">
                <label class="custom-control-label" for="hideRows">Hide No Reviews</label>
            </div>
        </div>
        <div class="sidebar-div my-2">
            <h5 class="sidebar-header">Statistics</h5>
                <ul class="list-group">
                    <li class="list-group-item list-group-item-light">
                        <p class="my-0"><u>Top Rated Gym</u></p>
                        <p class="my-1">{{ top_rated }}</p>
                    </li>
                    <li class="list-group-item list-group-item-light">
                        <p class="my-0"><u>Most Reviewed Gym</u></p>
                        <p class="my-1">{{ most_reviewed }}</p>
                    </li>
                    <li class="list-group-item list-group-item-light">
                        <p class="my-0"><u>Latest Review</u></p>
                        <p class="my-1">{{ latest_review.author.username }} - {{ latest_review.gym.name }}</p>
                        <p class="my-1">{{ latest_review.date_created|date:"SHORT_DATE_FORMAT" }}</p>
                    </li>
                    <li class="list-group-item list-group-item-light">
                        <p class="my-0">Total Review Count: {{ total_review_count }}</p>
                    </li>
                </ul>
            </p>
        </div>
    </div>
    <div class="col-md-9">
        <table class="table table-sm table-bordered table-striped" id="indexTable">
            <colgroup>
                <col style="width:22%">
                <col style="width:17%">
                <col style="width:20%">
                <col style="width:18%">
                <col style="width:23%">
            </colgroup>
            <thead class="table-header text-center">
                <tr>
                    <th>
                        Gym Name
                        <span class="sort-icon"><i class="fas fa-sort"></i></span>
                    </th>
                    <th>
                        Location
                        <span class="sort-icon"><i class="fas fa-sort"></i></span>
                    </th>
                    <th>
                        Average Rating
                        <span class="sort-icon"><i class="fas fa-sort"></i></span>
                    </th>
                    <th>
                        Rating Count
                        <span class="sort-icon"><i class="fas fa-sort"></i></span>
                    </th>
                    <th class="hide-small">
                        Total Days Trained
                        <span class="sort-icon"><i class="fas fa-sort"></i></span>
                    </th>
                </tr>
            </thead>
            <tbody class="table-body">
                {% for gym in gyms %}
                <tr>
                    <td class="searchable"><a href="{{ gym.get_absolute_url }}">{{ gym.name }}</a></td>
                    <td class="searchable">{{ gym.location.city }}</td>
                    <td>
                        {% if not gym.avg %}
                        No Ratings
                        {% else %}
                        {{ gym.avg|floatformat:1 }}
                        {% endif %}
                    </td>
                    <td>{{ gym.count }}</td>
                    <td class="hide-small">
                        {% if not gym.total_days %}
                            0
                        {% else %}
                            {{ gym.total_days }}
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
{% block scripts %}
<script src="{% static 'mtdb/js/tableFunctions.js' %}" type="text/javascript"> </script>
{% endblock %}